<!DOCTYPE HTML>
<html>
<head>
<title>Remote Media Center</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/remoteMediaCenter.css">
<script src="/js/jquery-3.3.1.js"></script>
<script src="/js/bootstrap.js"></script>
</head>
<body>
	<div class="container">
		<div class="page-header margin-header">
			<h1>Remote Media Center</h1>
		</div>
		<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
			<a class="navbar-brand" href="/screen.html">Screen</a>
			<a class="navbar-brand" href="/fileExplorer.html">File Explorer</a>
			<a class="navbar-brand" href="/media.html">Media Controls</a>
			<a class="navbar-brand" href="/system.html">System</a>
		</nav>
		<h2 class="margin-header">VLC Controls</h2>
		<div id="vlcControls">
			<div class="row">
				<button id="play" type="button" class="btn btn-primary">Play</button>
				<button id="stop" type="button" class="btn btn-primary">Stop</button>
				<button id="pause" type="button" class="btn btn-primary">Pause</button>
				<button id="close" type="button" class="btn btn-primary">Close</button>
			</div>
			<div class="row">
				<div class="slidecontainer">
				  <input type="range" min="0" max="1000" value="0" class="slider" id="range"/>
				</div>
			</div>
		</div>
		<div id="novlc" class="alert alert-warning" role="alert">
			VLC is not running. Go to the File Explorer and run from there any movie, or copy a Youtube link.
		</div>
			
		<h3>Youtube link</h3>
		<div class="row">
			<div class="input-group">
				<input type="url" id="link" class="form-control"/>
				<button id="openLink" type="button" class="btn btn-primary">Go</button>
			</div>
		</div>
		
		<h2 class="margin-header">OMX Controls (for Raspberry Pi)</h2>
		<div id="omxControls">
			<div class="row">
				<button id="stopOmx" type="button" class="btn btn-primary">Stop</button>
				<button id="pauseOmx" type="button" class="btn btn-primary">Pause</button>
				<button id="closeOmx" type="button" class="btn btn-primary">Close</button>
			</div>
		</div>
		<div id="noomx" class="alert alert-warning" role="alert">
			OMX is not running. Go to the File Explorer and run from there any movie.
		</div>
	</div>
	<script type = "text/javascript">
		$(document).ready(function() {
			checkRunning('vlc');
			checkRunning('omx');
			
			setButtonAction('vlc', 'play');
			setButtonAction('vlc', 'stop');
			setButtonAction('vlc', 'pause');
			setButtonAction('vlc', 'close');
			
			setButtonAction('omx', 'stopOmx');
			setButtonAction('omx', 'pauseOmx');
			setButtonAction('omx', 'closeOmx');
			
			$('#range').on('input', function () {
			    var top = $('#range').attr('max');
			    var value = $('#range').val();
			    $.ajax( {
		            url: '/media/vlc/position',
		            type : 'GET',
		            data : {top : top, value : value},
					contentType : 'application/json'
		        });
			});
			$('#openLink').on('click', function() {
				$.ajax({
					url : '/media/vlc/open',
					type : 'GET',
					contentType : 'application/json',
					data : {path : $('#link').val()},
					success: function(result){
						checkRunning();
		            }
				});
			});
		});
		
		function checkRunning(app){
			$("#"+app+"Controls").hide();
			$("#no"+app).hide();
			$.ajax( {
	            url: '/media/'+app+'/isrunning',
	            type : 'GET',
				contentType : 'application/json',
	            success: function(result){
	            	if(result === true){
	            		$("#"+app+"Controls").show();
	            	}else{
	            		$("#no"+app).show();
	            	}
	            }
	        });
		}
		
		function setButtonAction(app, id){
			$('#'+id).on('click', function() {
				$.ajax({
					url : '/media/'+app+'/'+id,
					type : 'GET',
					contentType : 'application/json',
					success: function(result){
						checkRunning(app);
					}
				});
			});
		}
		
	</script>
</body>
</html>